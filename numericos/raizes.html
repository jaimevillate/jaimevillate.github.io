<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>1. Ra√≠zes de equa√ß√µes</title>
<link rel="stylesheet" href="../css/book.css">
<link rel="icon" type="image/svg+xml" href="../img/favicon.svg">
<link rel="alternate icon" href="../img/favicon.ico">
</head>
<body id="top">
<header style="background-image:url(../img/numericos.png);
               background-repeat:no-repeat;
               background-position:right center">
<h1>1. Ra√≠zes de equa√ß√µes</h1>
<p>Jaime E. Villate. M√©todos Num√©ricos com Maxima,<br>
Universidade do Porto, Portugal, 2015</p>
</header>
<div class="menu">
<button class="menubtn">&#9776;</button>
<div class="menu-content">
<a href="../pt/index.html">In√≠cio</a>
<a href="../pt/courses/index.html">Disciplinas</a>
<a href="../pt/courses/computational_physics/index.html">F√≠sica Computacional</a>
<a href="./index.html">M√©todos Num√©ricos</a>
</div>
</div>
<section>
<h2 id="sec-1.1">1.1. Equa√ß√µes transcendentes</h2>
<p>
Algumas equa√ß√µes que dependem de uma vari√°vel <math id="eqn1" display="inline"><mrow><mi>x</mi></mrow></math> podem ser resolvidas
para obter um ou mais valores de <math id="eqn2" display="inline"><mrow><mi>x</mi></mrow></math> que verificam a equa√ß√£o. Por
exemplo, a equa√ß√£o <math id="eqn3" display="inline"><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>4</mn><mspace width="0.167em" /><mi>x</mi><mo>+</mo><mn>3</mn><mo>=</mo><mn>0</mn></mrow></math> tem duas solu√ß√µes, <math id="eqn4" display="inline"><mrow><mi>x</mi><mo>=</mo><mo>‚àí</mo><mn>1</mn></mrow></math> e <math id="eqn5" display="inline"><mrow><mi>x</mi><mo>=</mo><mo>‚àí</mo><mn>3</mn></mrow></math>,
e a equa√ß√£o <math id="eqn6" display="inline"><mrow><msup><mrow><mi mathvariant="normal">e</mi></mrow><mi>x</mi></msup></mrow></math> = 3 tem uma √∫nica solu√ß√£o
<math id="eqn7" display="inline"><mrow><mi>x</mi><mo>=</mo><mi>ln</mi><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1.0986</mn><mi>‚Ä¶</mi></mrow></math>. Existem equa√ß√µes,
chamadas <span class="concept">transcendentes</span>, em que n√£o √©
poss√≠vel escrever uma express√£o matem√°tica para a solu√ß√£o <math id="eqn8" display="inline"><mrow><mi>x</mi></mrow></math> e at√©
pode ser dif√≠cil determinar se existem solu√ß√µes e quantas. Por
exemplo, a equa√ß√£o <math id="eqn9" display="inline"><mrow><mi>x</mi><mo>+</mo><mn>1</mn><mo>=</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> √© uma equa√ß√£o transcendente; as suas
solu√ß√µes s√≥ podem ser calculadas de forma aproximada, usando m√©todos
num√©ricos.
</p>
<p>
Para facilitar a procura das solu√ß√µes de uma equa√ß√£o transcendente, √©
conveniente rescrev√™-la na forma <math id="eqn10" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow></math>; por exemplo, a equa√ß√£o
<math id="eqn11" display="inline"><mrow><mi>x</mi><mo>+</mo><mn>1</mn><mo>=</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> pode ser escrita como <math id="eqn12" display="inline"><mrow><mi>x</mi><mo>+</mo><mn>1</mn><mo>‚àí</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow></math>. O problema de
encontrar as solu√ß√µes consiste ent√£o em encontrar
as <span class="concept">ra√≠zes</span> da fun√ß√£o <math id="eqn13" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math>, ou seja, os
pontos onde o gr√°fico de <math id="eqn14" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> corta o eixo das abcissas. No exemplo
anterior, <math id="eqn15" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>‚àí</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math>, o gr√°fico da fun√ß√£o no intervalo <math id="eqn16" display="inline"><mrow><mn>0</mn><mo>‚â§</mo><mi>x</mi><mo>‚â§</mo><mn>2</mn><mspace width="0.167em" /><mi>œÄ</mi></mrow></math> obt√©m-se no Maxima com o seguinte comando:
</p>
<pre>
<span class="maxp">(%i1)</span> <span class="maxi">plot2d (x+1-tan(x), [x,0,2*%pi], [y,-5,5], [ylabel,"f(x)"]);
</pre>
<p>
e o resultado (ver Figura&nbsp;<a href="#fig-1.1">1.1</a>) mostra que
nesse intervalo existem duas solu√ß√µes, pr√≥ximas dos valores <math id="eqn17" display="inline"><mrow><mi>x</mi><mo>=</mo><mn>1.1</mn></mrow></math> e
<math id="eqn18" display="inline"><mrow><mi>x</mi><mo>=</mo><mn>4.5</mn></mrow></math>.
</p>
<figure class="center" id="fig-1.1">
<img class="fig" src="img/ftranscendente.png" alt="Ra√≠zes de uma fun√ß√£o"
     style="width:42.609em;max-width:100%;height:auto">
<figcaption><b>Figura 1.1:</b> Gr√°fico da fun√ß√£o <math id="eqn19" display="inline"><mrow><mi>x</mi><mo>+</mo><mn>1</mn><mo>‚àí</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math>.</figcaption>
</figure>
<p>
No caso das fun√ß√µes cont√≠nuas, se em dois pontos diferentes <math id="eqn20" display="inline"><mrow><mi>a</mi></mrow></math> e <math id="eqn21" display="inline"><mrow><mi>b</mi></mrow></math>
(admitindo <math id="eqn22" display="inline"><mrow><mi>a</mi><mo><</mo><mi>b</mi></mrow></math>), os sinais de <math id="eqn23" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></math> e <math id="eqn24" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></math> s√£o diferentes,
deve existir pelo menos uma raiz de <math id="eqn25" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> no intervalo <math id="eqn26" display="inline"><mrow><mi>a</mi><mo><</mo><mi>x</mi></mrow></math> &lt;
<math id="eqn27" display="inline"><mrow><mi>b</mi></mrow></math>. No caso da Figura&nbsp;<a href="#fig-1.1">1.1</a>, v√™-se que
<math id="eqn28" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></math> √© positiva mas <math id="eqn29" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>1.3</mn><mo stretchy="false">)</mo></mrow></math> √© negativa; assim sendo, existe pelo
menos uma raiz entre 0 e 1.3. Em <math id="eqn30" display="inline"><mrow><mi>x</mi><mo>=</mo><mn>3</mn></mrow></math>, <math id="eqn31" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></math> √© positiva, mas
comparando com o valor negativo de <math id="eqn32" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>1.3</mn><mo stretchy="false">)</mo></mrow></math> n√£o se pode concluir que
existam ra√≠zes no intervalo <math id="eqn33" display="inline"><mrow><mn>1.3</mn><mo><</mo><mi>x</mi><mo><</mo><mn>3</mn></mrow></math>, j√° que nesse intervalo a
fun√ß√£o n√£o √© cont√≠nua.
</p>
</section>
<section>
<h2 id="sec-1.2">1.2. M√©todo de bissec√ß√µes</h2>
<p>
Dados dois valores diferentes <math id="eqn34" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></math> e <math id="eqn35" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math>, onde <math id="eqn36" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub><mo><</mo><msub><mi>x</mi><mn>2</mn></msub></mrow></math> e
<math id="eqn37" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mspace width="0.167em" /><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo><</mo><mn>0</mn></mrow></math> (ou seja, os sinais de <math id="eqn38" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></math> e <math id="eqn39" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></math> s√£o
diferentes), calculam-se o ponto meio <math id="eqn40" display="inline"><mrow><msub><mi>x</mi><mi>m</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>/</mo><mn>2</mn></mrow></math> e o valor da
fun√ß√£o nesse ponto, <math id="eqn41" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow></math>. Se <math id="eqn42" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow></math> for nula, <math id="eqn43" display="inline"><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow></math> √© a raiz
procurada; caso contr√°rio, se o sinal de <math id="eqn44" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow></math> for o mesmo de
<math id="eqn45" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></math> substitui-se <math id="eqn46" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></math> por <math id="eqn47" display="inline"><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow></math>, se o sinal de <math id="eqn48" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow></math> for o
mesmo de <math id="eqn49" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></math> substitui-se <math id="eqn50" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math> por <math id="eqn51" display="inline"><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow></math> e o processo repete-se
indefinidamente at√© se obter um intervalo de comprimento muito
reduzido:
</p>
<div class="eqnalign" id="eq-1.1">
<div class="eqn">(1.1)</div>
<math id="eqn52" display="block"><mrow><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>2</mn></msub><mo>‚àí</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">|</mo><mo><</mo><mi>Œµ</mi></mrow></mrow></math>
</div>
<p>
onde <math id="eqn53" display="inline"><mrow><mi>Œµ</mi></mrow></math>/2 √© a precis√£o com que se quer calcular a raiz. O
valor final de <math id="eqn54" display="inline"><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow></math> ser√° o que melhor aproxima o valor da raiz, com a
precis√£o desejada.
</p>
<div class="example" id="ex-1.1">
<span class="example_heading">Exemplo 1.1</span>
<p>
Calcule a raiz de <math id="eqn55" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>‚àí</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> no intervalo 0 &lt; <math id="eqn56" display="inline"><mrow><mi>x</mi></mrow></math>
&lt; 1.3 com 2 casas decimais, usando o m√©todo de bisse√ß√µes.
</p>
</div>
<p>
<b>Resolu√ß√£o</b>. Definem-se primeiro a fun√ß√£o e os pontos iniciais:
</p>
<pre>
<span class="maxp">(%i2)</span> <span class="maxi">f(x) := x+1-tan(x)$</span><br>
<span class="maxp">(%i3)</span> <span class="maxi">[ x1, x2 ]: [ 1.0, 1.2 ]$</span><br>
</pre>
<p>
√â importante dar os valores iniciais em formato de v√≠rgula flutuante,
para que a fun√ß√£o <span class="concept">tan</span> seja calculada, em
v√≠rgula flutuante, em vez de ficar como valor simb√≥lico. Note-se
tamb√©m que no Maxima 1. √© interpretado como o inteiro 1, mas 1.0 √©
representado em v√≠rgula flutuante.
</p>
<p>
Os valores da fun√ß√£o nos pontos iniciais s√£o
</p>
<pre>
<span class="maxp">(%i4)</span> <span class="maxi">[ f(x1), f(x2) ];</span><br>
(%o4)  [0.4425922753450977, ‚àí0.3721516221263186]
</pre>
<p>
e como os sinais s√£o diferentes, √© poss√≠vel usar o m√©todo das
bissec√ß√µes. O ponto meio e o valor da fun√ß√£o nesse ponto s√£o:
</p>
<pre>
<span class="maxp">(%i5)</span> <span class="maxi">[ xm: (x1+x2)/2, f(xm) ];</span><br>
(%o5)  [1.1, 0.13524034275134778]
</pre>
<p>
Como o sinal da fun√ß√£o nesse ponto √© positivo, substitui-se <math id="eqn57" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></math> pelo
ponto meio e repete-se o passo anterior:
</p>
<pre>
<span class="maxp">(%i6)</span> <span class="maxi">x1: xm$</span><br>
<span class="maxp">(%i7)</span> <span class="maxi">[ xm: (x1+x2)/2, f(xm) ];</span><br>
(%o7)  [1.15, ‚àí0.08449694875532554]
</pre>
<p>
Como agora a fun√ß√£o √© negativa, substitui-se <math id="eqn58" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math> por <math id="eqn59" display="inline"><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow></math> e
repete-se o mesmo procedimento at√© se observar que o ponto meio n√£o
mude, at√© √† segunda casa decimal:
</p>
<pre>
<span class="maxp">(%i8)</span> <span class="maxi">x2: xm$</span><br>
<span class="maxp">(%i9)</span> <span class="maxi">[ xm: (x1+x2)/2, f(xm) ];</span><br>
(%o9)  [1.125, 0.03242872362782112]
<span class="maxp">(%i10)</span> <span class="maxi">x1: xm$</span><br>
<span class="maxp">(%i11)</span> <span class="maxi">[ xm: (x1+x2)/2, f(xm) ];</span><br>
(%o11)  [1.1375, ‚àí0.02411658214848611]
<span class="maxp">(%i12)</span> <span class="maxi">x2: xm$</span><br>
<span class="maxp">(%i13)</span> <span class="maxi">[ xm: (x1+x2)/2, f(xm) ];</span><br>
(%o13)  [1.13125, 0.00461493349083808]
</pre>
<p>
O valor da raiz √© <math id="eqn60" display="inline"><mrow><mi>x</mi><mo>=</mo><mn>1.13</mn></mrow></math>. H√° que ter muita aten√ß√£o a qual dos
valores, <math id="eqn61" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></math> ou <math id="eqn62" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math>, deve ser substitu√≠do por <math id="eqn63" display="inline"><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow></math>, para garantir
que a raiz esteja sempre dentro do intervalo atual.
</p>
<p>
As itera√ß√µes tamb√©m podiam ter sido feitas mais rapidamente usando um
ciclo <span class="concept">while</span>. Por exemplo, para encontrar a
raiz com 3 casas decimais (precis√£o igual a 0.0005), come√ßando com os
mesmos valores iniciais, pode escrever-se:
</p>
<pre>
<span class="maxp">(%i14)</span> <span class="maxi">[ x1, x2 ]: [ 1.1, 1.2 ]$</span><br>
<span class="maxp">(%i15)</span> <span class="maxi"> while abs (x2-x1) > 0.001 do (</span><br>
          <span class="maxi">xm: (x1+x2)/2,</span><br>
          <span class="maxi">if f(x1)*f(xm) &gt; 0</span><br>
             <span class="maxi">then x1: xm</span><br>
             <span class="maxi">else x2: xm,</span><br>
          <span class="maxi">print(xm)</span><br>
       <span class="maxi">)$</span><br>
1.15 <br>
1.125 <br>
1.1375 <br>
1.13125 <br>
1.134375 <br>
1.1328125 <br>
1.13203125
</pre>
<p>
A raiz, com precis√£o de 3 casas decimais √© 1.132. Observe-se que a
fun√ß√£o j√° tinha sido definida previamente e que j√° estava garantido
que os sinais da fun√ß√£o s√£o diferentes nos dois pontos iniciais.
</p>
</section>
<section>
<h2 id="sec-1.3">1.3. M√©todo de falsa posi√ß√£o</h2>
<p>
No m√©todo das bissec√ß√µes, se um dos valores <math id="eqn64" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></math> ou <math id="eqn65" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></math>
estiver muito mais pr√≥ximo de zero, espera-se que a raiz tamb√©m esteja
mas pr√≥xima do ponto <math id="eqn66" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></math> ou <math id="eqn67" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math> em que a fun√ß√£o est√° mais pr√≥xima
de zero. Como tal, ser√° mais eficiente usar o ponto <math id="eqn68" display="inline"><mrow><msub><mi>x</mi><mi>r</mi></msub></mrow></math> em que a
reta que passa pelos pontos (<math id="eqn69" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></math>, <math id="eqn70" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></math>) e (<math id="eqn71" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math>, <math id="eqn72" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></math>)
intersecta o eixo dos <math id="eqn73" display="inline"><mrow><mi>x</mi></mrow></math>. Uma rela√ß√£o geom√©trica de semelhan√ßa entre
tri√¢ngulos permite demonstrar que <math id="eqn74" display="inline"><mrow><msub><mi>x</mi><mi>r</mi></msub></mrow></math> √© dado pela express√£o
</p>
<div class="eqnalign" id="eq-1.2">
<div class="eqn">(1.2)</div>
<math id="eqn75" display="block"><mrow><mrow><msub><mi>x</mi><mi>r</mi></msub><mo>=</mo><msub><mi>x</mi><mn>2</mn></msub><mo>‚àí</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>‚àí</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>‚àí</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mstyle></mrow></mrow></math>
</div>
<p>
O m√©todo de falsa posi√ß√£o √© semelhante ao m√©todo de bissec√ß√µes,
excepto que em vez de se usar o ponto meio de cada intervalo usa-se o
ponto <math id="eqn76" display="inline"><mrow><msub><mi>x</mi><mi>r</mi></msub></mrow></math> definido pela equa√ß√£o anterior.
</p>
<div class="example" id="ex-1.2">
<span class="example_heading">Exemplo 1.2</span>
<p>
Calcule a raiz de <math id="eqn77" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>‚àí</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> no intervalo <math id="eqn78" display="inline"><mrow><mn>0</mn><mo><</mo><mi>x</mi><mo><</mo><mn>1.3</mn></mrow></math> com
3 casas decimais, usando o m√©todo de falsa posi√ß√£o.
</p>
</div>
<p>
<b>Resolu√ß√£o</b>. Aproveitando que a fun√ß√£o √© a mesma que j√° foi
definida no exemplo da sec√ß√£o anterior, basta definir novamente os
valores iniciais e modificar o ciclo <span class="concept">while</span>
usado na sec√ß√£o anterior. √â conveniente tamb√©m guardar os valores da
fun√ß√£o j√° calculados, para evitar a redund√¢ncia de serem calculados
novamente a cada itera√ß√£o:
</p>
<pre>
<span class="maxp">(%i16)</span> <span class="maxi">[ x1, x2 ]: [ 1.1, 1.2 ]$</span><br>
<span class="maxp">(%i17)</span> <span class="maxi">[ f1, f2 ]: [ f(x1), f(x2) ];</span><br>
(%o17)  [0.13524034275134778, ‚àí0.3721516221263186]
</pre>
<p>
Os valores da fun√ß√£o nos dois extremos do intervalo s√£o armazenados
nas vari√°veis <math id="eqn79" display="inline"><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow></math> e <math id="eqn80" display="inline"><mrow><msub><mi>f</mi><mn>2</mn></msub></mrow></math>; o resultado (<kbd>%o17</kbd>) permite
tamb√©m conferir que o sinal da fun√ß√£o muda entre <math id="eqn81" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></math> e <math id="eqn82" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math>. Como
ser√° claro nos resultados no fim deste exemplo, neste m√©todo a
dist√¢ncia entre <math id="eqn83" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></math> e <math id="eqn84" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math> n√£o tem que ser pequena para que o valor
<math id="eqn85" display="inline"><mrow><msub><mi>x</mi><mi>r</mi></msub></mrow></math> esteja muito pr√≥ximo da raiz. Assim sendo, a condi√ß√£o de paragem
<math id="eqn86" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>2</mn></msub><mo>‚àí</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">|</mo><mo><</mo><mi>œµ</mi></mrow></math> j√° n√£o serve e no seu lugar deve comparar-se
cada valor <math id="eqn87" display="inline"><mrow><msub><mi>x</mi><mi>r</mi></msub></mrow></math> com o que tenha sido obtido na itera√ß√£o anterior, que
representaremos por <math id="eqn88" display="inline"><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></math>. Inicialmente pode admitir-se que <math id="eqn89" display="inline"><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></math> e
<math id="eqn90" display="inline"><mrow><msub><mi>x</mi><mi>r</mi></msub></mrow></math> s√£o os pr√≥prios <math id="eqn91" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></math> e <math id="eqn92" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math>.
</p>
<pre>
<span class="maxp">(%i18)</span> <span class="maxi">[ x0, xr ]: [ x1, x2 ]$</span>
</pre>
<p>
Para obter a precis√£o de 3 casas decimais, usa-se o comando:
</p>
<pre>
<span class="maxp">(%i19)</span> <span class="maxi">while abs (xr-x0) &gt; 0.0005 do (</span><br>
          <span class="maxi">x0: xr,</span><br>
          <span class="maxi">xr: x2-f2*(x2-x1)/(f2-f1),</span><br>
          <span class="maxi">fr: f(xr),</span><br>
          <span class="maxi">print (x1, x2, xr),</span><br>
          <span class="maxi">if f1*fr &gt; 0</span><br>
             <span class="maxi">then (x1: xr, f1: fr)</span><br>
             <span class="maxi">else (x2: xr, f2: fr)</span><br>
       <span class="maxi">)$</span><br>
1.1 1.2 1.1266540174289033 <br>
1.1266540174289033 1.2 1.1312978514698286 <br>
1.1312978514698286 1.2 1.1321003635910354 <br>
1.1321003635910354 1.2 1.1322388513229094 
</pre>
<p>
Note-se que o valor da raiz com tr√™s casas decimais, 1.132, foi obtido
na quarta itera√ß√£o, enquanto que no m√©todo de bisse√ß√µes foram precisas
7 itera√ß√µes. Neste caso foram tamb√©m apresentados os valores de <math id="eqn93" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></math>
e <math id="eqn94" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math> em cada itera√ß√£o, para mostrar que o valor de <math id="eqn95" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math> permanece
sempre em 1.2 e, como tal, <math id="eqn96" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>2</mn></msub><mo>‚àí</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">|</mo></mrow></math> n√£o diminui muito.
</p>
</section>
<section>
<h2 id="sec-1.4">1.4. M√©todo de aproxima√ß√µes sucessivas</h2>
<p>
Quando a equa√ß√£o <math id="eqn97" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow></math> pode ser escrita da forma,
</p>
<div class="eqnalign" id="eq-1.3">
<div class="eqn">(1.3)</div>
<math id="eqn98" display="block"><mrow><mrow><mi>x</mi><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></math>
</div>
<p>
o m√©todo de aproxima√ß√µes sucessivas consiste em come√ßar com um valor
inicial <math id="eqn99" display="inline"><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></math> e calcular a sequ√™ncia <math id="eqn100" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></math>, <math id="eqn101" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></math>,
&hellip; Dependendo da fun√ß√£o <math id="eqn102" display="inline"><mrow><mi>g</mi></mrow></math> e do valor inicial, em alguns casos
a sequ√™ncia aproxima-se de um limite, isto √©, dentro de uma toler√¢ncia
num√©rica dada, o valor de <math id="eqn103" display="inline"><mrow><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></math> ser√° igual a <math id="eqn104" display="inline"><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow></math> a partir de
algum inteiro <math id="eqn105" display="inline"><mrow><mi>n</mi></mrow></math> e, nesse caso <math id="eqn106" display="inline"><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow></math> ser√° raiz de <math id="eqn107" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math>.
</p>
<div class="example" id="ex-1.3">
<span class="example_heading">Exemplo 1.3</span>
<p>
Encontre a raiz de <math id="eqn108" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>‚àí</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> mais pr√≥xima de <math id="eqn109" display="inline"><mrow><mi>x</mi><mo>=</mo><mn>1.1</mn></mrow></math>, com 3
casas decimais, usando o m√©todo de aproxima√ß√µes sucessivas.
</p>
</div>
<p>
<b>Resolu√ß√£o</b>. A equa√ß√£o <math id="eqn110" display="inline"><mrow><mi>x</mi><mo>+</mo><mn>1</mn><mo>‚àí</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow></math> pode tamb√©m ser escrita:
</p>
<div class="eqnalign">
<math id="eqn111" display="block"><mrow><mrow><mi>x</mi><mo>=</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mn>1</mn></mrow></mrow></math>
</div>
<p>
Definindo a fun√ß√£o <math id="eqn112" display="inline"><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mn>1</mn></mrow></math> e com valor inicial <math id="eqn113" display="inline"><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mn>1.1</mn></mrow></math>, os
seguintes 6 valores na sequ√™ncia <math id="eqn114" display="inline"><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></math> s√£o:
</p>
<pre>
<span class="maxp">(%i20)</span> <span class="maxi">g(x) := float (tan(x)-1)$</span><br>
<span class="maxp">(%i21)</span> <span class="maxi">xi: 1.1$</span><br>
<span class="maxp">(%i22)</span> <span class="maxi">for i:1 thru 6 do (xi: g(xi), print (xi))$</span><br>
0.9647596572486523 <br>
0.44292698588645374 <br>
‚àí0.5256388221063686<br> 
‚àí1.5800735425078773 <br>
106.78786888891254 <br>
‚àí1.0262873857258117 
</pre>
<p>
Esta sequ√™ncia n√£o parece ser convergente. O problema neste caso √© que
uma das condi√ß√µes para que a sequ√™ncia seja convergente √© que, na
vizinhan√ßa da raiz que se pretende encontrar, o declive de <math id="eqn115" display="inline"><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> seja
menor que 1, que n√£o √© o que acontece neste caso:
</p>
<pre>
<span class="maxp">(%i23)</span> <span class="maxi">subst (x=1.1, diff (tan(x)-1, x));</span><br>
(%o23)  4.860280510751842
</pre>
<p>
O problema pode ser resolvido quando se consegue inverter a fun√ß√£o
usada. Ou seja, em vez de se usar <math id="eqn116" display="inline"><mrow><mi>x</mi><mo>=</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mn>1</mn></mrow></math> pode usar-se a equa√ß√£o
inversa, <math id="eqn117" display="inline"><mrow><mi>arctan</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></mrow></math>, que implica usar <math id="eqn118" display="inline"><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>arctan</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></math>. No
Maxima, a fun√ß√£o inversa da tangente √© a
fun√ß√£o <span class="concept">atan</span>. Com valor inicial <math id="eqn119" display="inline"><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mn>1.1</mn></mrow></math>, os
primeiros termos da sequ√™ncia <math id="eqn120" display="inline"><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></math> s√£o:
</p>
<pre>
<span class="maxp">(%i24)</span> <span class="maxi">g(x) := atan(x+1)$</span><br>
<span class="maxp">(%i25)</span> <span class="maxi">xi: 1.1$</span><br>
<span class="maxp">(%i26)</span> <span class="maxi">for i:1 thru 6 do (xi: g(xi), print (xi))$</span><br>
1.1263771168937977 <br>
1.1312032871603384 <br>
1.1320757373086228 <br>
1.1322331088729125 <br>
1.1322614841386753 <br>
1.1322666000452082 
</pre>
<p>
que converge rapidamente para o valor da raiz.
</p>
</section>
<section>
<h2 id="sec-1.5">1.5. M√©todo de Newton</h2>
<p>
Tal como no m√©todo de aproxima√ß√µes sucessivas, basta ter um valor
inicial para criar uma sequ√™ncia que se aproxima da raiz. As vantagens
em rela√ß√£o ao m√©todo de aproxima√ß√µes sucessivas √© que n√£o √© preciso
escrever a equa√ß√£o <math id="eqn121" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> = 0 na forma <math id="eqn122" display="inline"><mrow><mi>x</mi><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> e a sequ√™ncia converge
em muitos mais casos. A desvantagem √© que √© preciso conhecer a
derivada, <math id="eqn123" display="inline"><mrow><msup><mi>f</mi><mi>‚Ä≤</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math>, da fun√ß√£o <math id="eqn124" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math>.
</p>
<p>
Se <math id="eqn125" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> √© uma fun√ß√£o cont√≠nua e deriv√°vel, o valor de <math id="eqn126" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></math>
pode ser calculado, a partir do valor de <math id="eqn127" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></math>, usando a s√©rie de
Taylor
</p>
<div class="eqnalign" id="eq-1.4">
<div class="eqn">(1.4)</div>
<math id="eqn128" display="block"><mrow><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚àí</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mspace width="0.167em" /><msup><mi>f</mi><mi>‚Ä≤</mi></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mo>‚ãØ</mo></mrow></mrow></math>
</div>
<p>
Se <math id="eqn129" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚àí</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">|</mo></mrow></math> for suficientemente pequeno, os dois primeiros
termos da s√©rie, apresentados na equa√ß√£o acima, s√£o uma boa
aproxima√ß√£o para o valor da s√©rie completa. Se o ponto <math id="eqn130" display="inline"><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></math> for
uma raiz, ent√£o <math id="eqn131" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></math> = 0 e a equa√ß√£o anterior conduz √† rela√ß√£o
de recorr√™ncia,
</p>
<div class="eqnalign" id="eq-1.5">
<div class="eqn">(1.5)</div>
<math id="eqn132" display="block"><mrow><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>‚àí</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><msup><mi>f</mi><mi>‚Ä≤</mi></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mstyle></mrow></mrow></math>
</div>
<p>
que permite definir uma sequ√™ncia de valores <math id="eqn133" display="inline"><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></math> que dever√°
aproximar-se do valor da raiz.
</p>
<div class="example" id="ex-1.4">
<span class="example_heading">Exemplo 1.4</span>
<p>
Encontre a raiz de <math id="eqn134" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>‚àí</mo><mi>tan</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> mais pr√≥xima de <math id="eqn135" display="inline"><mrow><mi>x</mi><mo>=</mo><mn>1.1</mn></mrow></math>, com 3
casas decimais, usando o m√©todo de Newton.
</p>
</div>
<p>
<b>Resolu√ß√£o</b>. A fun√ß√£o <math id="eqn136" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math> j√° foi definida no comando
(<kbd>%i2</kbd>) mas como √© necess√°rio tamb√©m definir a sua derivada,
vamos defini-la novamente usando o
comando <span class="concept">define</span>, que √© mais apropriado para
definir fun√ß√µes matem√°ticas:
</p>
<pre>
<span class="maxp">(%i27)</span> <span class="maxi">define (f(x), x+1-tan(x))$</span><br>
<span class="maxp">(%i28)</span> <span class="maxi"> define (df(x), diff (f(x), x));</span><br>
                        2
(%o28)  df(x) := 1 - sec (x)
</pre>
<p>
A diferen√ßa entre <span class="concept">define</span>
e <span class="concept">:=</span>, √© que no primeiro caso o argumento
dado ao comando √© avaliado imediatamente; neste caso, a derivada √©
realizada antes de proceder √† defini√ß√£o da fun√ß√£o. Se tiv√©ssemos usado 
<span class="concept">:=</span> para definir a derivada <math id="eqn137" display="inline"><mrow><mi>d</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></math>, a
fun√ß√£o <span class="concept">diff</span> n√£o seria executada
imediatamente, ficando no argumento da fun√ß√£o; quando quisermos
calcular, por exemplo, <math id="eqn138" display="inline"><mrow><mi>d</mi><mi>f</mi><mo stretchy="false">(</mo><mn>1.2</mn><mo stretchy="false">)</mo></mrow></math>, o valor 1.2 seria substitu√≠do no
comando <span class="concept">diff</span>
ficando <span class="maxi">diff(f(1.2), 1.2)</span> que produz erro,
porque <span class="concept">diff</span> espera que o segundo
argumento seja uma vari√°vel, e n√£o um n√∫mero.
</p>
<p>
Usando o valor inicial <math id="eqn139" display="inline"><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mn>1.1</mn></mrow></math>, os seguintes 6 valores na sequ√™ncia
<math id="eqn140" display="inline"><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></math> s√£o:
</p>
<pre>
<span class="maxp">(%i29)</span> <span class="maxi">xi: 1.1$</span><br>
<span class="maxp">(%i30)</span> <span class="maxi">for i: 1 thru 6 do (xi: xi-f(xi)/df(xi), print (xi))$</span><br>
1.1350338122772867 <br>
1.1322875938008696 <br>
1.1322677262997385 <br>
1.132267725272885 <br>
1.132267725272885 <br>
1.132267725272885 
</pre>
<p>
Note-se a rapidez com que o m√©todo converge; ap√≥s apenas 3 intera√ß√µes
j√° se obt√™m 4 casas decimais para a raiz e ap√≥s a quinta itera√ß√£o j√° √©
obtida a solu√ß√£o com o n√∫mero m√°ximo de casas decimais (15) que √©
poss√≠vel obter com o formato de dupla precis√£o num√©rica usado pela
fun√ß√£o <span class="concept">float</span>.
</p>
</section>
<section>
<h2 id="sec-1.6">1.6. Sistemas de equa√ß√µes transcendentes</h2>
<p>
O m√©todo de Newton pode ser generalizado facilmente para
resolver um sistema de <math id="eqn141" display="inline"><mrow><mi>n</mi></mrow></math> vari√°veis com <math id="eqn142" display="inline"><mrow><mi>n</mi></mrow></math> equa√ß√µes
cont√≠nuas e deriv√°veis. Por exemplo, no caso de duas equa√ß√µes
com duas vari√°veis, <math id="eqn143" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></math> = 0 e <math id="eqn144" display="inline"><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></math> = 0, os primeiros
termos nas s√©ries de Taylor para as duas fun√ß√µes s√£o:
</p>
<div class="eqnalign" id="eq-1.6">
<div class="eqn">(1.6)</div>
<math id="eqn145" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></math>
<math id="eqn146" display="inline"><mrow><mtext>¬†</mtext><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚àí</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mrow><mo stretchy="true" fence="true" form="prefix">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>‚àÇ</mo><mi>f</mi></mrow><mrow><mo>‚àÇ</mo><mi>x</mi></mrow></mfrac></mstyle><mo stretchy="true" fence="true" form="postfix">)</mo></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
<math id="eqn147" display="inline"><mrow><mtext>¬†</mtext><mo>+</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚àí</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mrow><mo stretchy="true" fence="true" form="prefix">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>‚àÇ</mo><mi>f</mi></mrow><mrow><mo>‚àÇ</mo><mi>y</mi></mrow></mfrac></mstyle><mo stretchy="true" fence="true" form="postfix">)</mo></mrow><mrow><mi>i</mi></mrow></msub></mrow></math><br>
<math id="eqn148" display="inline"><mrow><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></math>
<math id="eqn149" display="inline"><mrow><mtext>¬†</mtext><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚àí</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mrow><mo stretchy="true" fence="true" form="prefix">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>‚àÇ</mo><mi>g</mi></mrow><mrow><mo>‚àÇ</mo><mi>x</mi></mrow></mfrac></mstyle><mo stretchy="true" fence="true" form="postfix">)</mo></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
<math id="eqn150" display="inline"><mrow><mtext>¬†</mtext><mo>+</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚àí</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mrow><mo stretchy="true" fence="true" form="prefix">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>‚àÇ</mo><mi>g</mi></mrow><mrow><mo>‚àÇ</mo><mi>y</mi></mrow></mfrac></mstyle><mo stretchy="true" fence="true" form="postfix">)</mo></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
</div>
</div>
<p>
Os √≠ndices <math id="eqn151" display="inline"><mrow><mi>i</mi></mrow></math> nas derivadas indicam que <math id="eqn152" display="inline"><mrow><mi>x</mi></mrow></math> e <math id="eqn153" display="inline"><mrow><mi>y</mi></mrow></math> devem ser
substitu√≠das por (<math id="eqn154" display="inline"><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></math>, <math id="eqn155" display="inline"><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow></math>). Substituindo <math id="eqn156" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow></math> e
<math id="eqn157" display="inline"><mrow><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow></math> e escrevendo o sistema de forma matricial,
obt√©m-se,
</p>
<div class="eqnalign" id="eq-1.7">
<div class="eqn">(1.7)</div>
<math id="eqn158" display="block"><mrow><mrow><mi>ùêâ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mspace width="0.167em" /><mo stretchy="false">(</mo><msub><mi>ùê´</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚àí</mo><msub><mi>ùê´</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mo>‚àí</mo><mi>ùêÖ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math>
</div>
<p>
onde <math id="eqn159" display="inline"><mrow><mi>ùêâ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></math> √© a <span class="concept">matriz
jacobiana</span>:
</p>
<div class="eqnalign" id="eq-1.8">
<div class="eqn">(1.8)</div>
<math id="eqn160" display="block"><mrow><mrow><mi>ùêâ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo>[</mo><mtable><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>‚àÇ</mo><mi>f</mi></mrow><mrow><mo>‚àÇ</mo><mi>x</mi></mrow></mfrac></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>‚àÇ</mo><mi>f</mi></mrow><mrow><mo>‚àÇ</mo><mi>y</mi></mrow></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>‚àÇ</mo><mi>g</mi></mrow><mrow><mo>‚àÇ</mo><mi>x</mi></mrow></mfrac></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>‚àÇ</mo><mi>g</mi></mrow><mrow><mo>‚àÇ</mo><mi>y</mi></mrow></mfrac></mstyle></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math>
</div>
<p>
calculada em <math id="eqn161" display="inline"><mrow><mi>x</mi><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></math> e <math id="eqn162" display="inline"><mrow><mi>y</mi><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></math>. As matrizes <math id="eqn163" display="inline"><mrow><msub><mi>ùê´</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></math>,
<math id="eqn164" display="inline"><mrow><msub><mi>ùê´</mi><mi>i</mi></msub></mrow></math> e <math id="eqn165" display="inline"><mrow><mi>ùêÖ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></math> s√£o:
</p>
<div class="eqnalign" id="eq-1.9">
<div class="eqn">(1.9)</div>
<math id="eqn166" display="inline"><mrow><msub><mi>ùê´</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mo>[</mo><mtable><mtr><mtd><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math>
&emsp; <math id="eqn167" display="inline"><mrow><msub><mi>ùê´</mi><mi>i</mi></msub><mo>=</mo><mo>[</mo><mtable><mtr><mtd><msub><mi>x</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mi>i</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></math> &emsp;
<math id="eqn168" display="inline"><mrow><mi>ùêÖ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mo>[</mo><mtable><mtr><mtd><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mtd></mtr></mtable><mo>]</mo></mrow></math>
</div>
<p>
A equa√ß√£o&nbsp;(<a href="#eq-1.7">1.7</a>) permite definir a rela√ß√£o de
recorr√™ncia para <math id="eqn169" display="inline"><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></math> e <math id="eqn170" display="inline"><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></math>,
</p>
<div class="eqnalign" id="eq-1.10">
<div class="eqn">(1.10)</div>
<math id="eqn171" display="block"><mrow><mrow><msub><mi>ùê´</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>ùê´</mi><mi>i</mi></msub><mo>‚àí</mo><msup><mi>ùêâ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mspace width="0.167em" /><mi>ùêÖ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math>
</div>
<p>
onde <math id="eqn172" display="inline"><mrow><msup><mi>ùêâ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></math> √© a matriz inversa da matriz jacobiana.
</p>
<div class="example" id="ex-1.5">
<span class="example_heading">Exemplo 1.5</span>
<p>
Encontre os pontos de intersec√ß√£o da circunfer√™ncia <math id="eqn173" display="inline"><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mn>3</mn></mrow></math> com a
hip√©rbole <math id="eqn174" display="inline"><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>/</mo><mi>x</mi></mrow></math>.
</p>
</div>
<p>
<b>Resolu√ß√£o</b>. Os gr√°ficos da circunfer√™ncia e da hip√©rbole podem
ser tra√ßados com o comando:
</p>
<pre>
<span class="maxp">(%i31)</span> <span class="maxi">plot2d ([x^2+y^2=3, y=1/x], [x, -3, 3], [y, -2.25, 2.25], nolegend)$</span>
</pre>
<figure class="center" id="fig-1.2">
<img class="fig" src="img/circunferencia-hiperbole.png"
     alt="circunferencia-hiperbole" style="width:42.609em;max-width:100%;height:auto">
<figcaption>
<b>Figura 1.2:</b> Gr√°ficos da circunfer√™ncia <math id="eqn175" display="inline"><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mn>3</mn></mrow></math> e a
hip√©rbole <math id="eqn176" display="inline"><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>/</mo><mi>x</mi></mrow></math>.
</figcaption>
</figure>
<p>
O gr√°fico (Figura&nbsp;<a href="#fig-1.2">1.2</a>) mostra que existem
quatro pontos de intersec√ß√£o, sim√©tricos em rela√ß√£o √†s retas <math id="eqn177" display="inline"><mrow><mi>y</mi><mo>=</mo><mi>¬±</mi><mi>x</mi></mrow></math>.
Basta encontrar um desses quatro pontos, por exemplo, o que est√°
mais pr√≥ximo do ponto inicial <math id="eqn178" display="inline"><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mn>0.5</mn></mrow></math>, <math id="eqn179" display="inline"><mrow><msub><mi>y</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow></math>. Escrevendo as duas
equa√ß√µes da forma <math id="eqn180" display="inline"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow></math> e <math id="eqn181" display="inline"><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow></math>, as duas fun√ß√µes s√£o
definidas pelas express√µes,
</p>
<pre>
<span class="maxp">(%i32)</span> <span class="maxi">[f, g]: [x^2+y^2-3, 1-x*y]$</span>
</pre>
<p>
A matriz jacobiana calcula-se no Maxima usando a
fun√ß√£o <span class="concept">jacobian</span>, √† qual h√° que dar a
lista de express√µes a derivar, e a lista das vari√°veis. A inversa da
matriz jacobiana pode ser calculada com a
fun√ß√£o <span class="concept">invert</span>. Vamos definir uma fun√ß√£o
<math id="eqn182" display="inline"><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></math> que calcular√° o produto
<math id="eqn183" display="inline"><mrow><msup><mi>ùêâ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mspace width="0.167em" /><mi>ùêÖ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></math> na equa√ß√£o (<a href="#eq-1.10">1.10</a>),
para valores dados de <math id="eqn184" display="inline"><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></math> e <math id="eqn185" display="inline"><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow></math>:
</p>
<pre>
<span class="maxp">(%i33)</span> <span class="maxi">define (H(x,y), list_matrix_entries (invert (jacobian ([f, g], [x, y])).[f, g]))$</span>
</pre>
<p>
A matriz <math id="eqn186" display="inline"><mrow><mi>ùêÖ</mi></mrow></math> da equa√ß√£o (<a href="#eq-1.9">1.9</a>) foi dada como uma lista, em vez
duma matriz coluna, mas o Maxima interpreta o produto de matriz por
lista como um produto de matriz por matriz coluna (o ponto entre a
matriz e a lista indica produto matricial). O produto da inversa da
matriz jacobiana vezes essa lista √© uma matriz com uma linha e duas
colunas, mas como √© mais f√°cil trabalhar com listas, foi usado o
comando <span class="concept">list_matrix_entries</span> para converter
essa matriz numa lista. Como tal, dados os valores de <math id="eqn187" display="inline"><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></math> e <math id="eqn188" display="inline"><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow></math>, a
fun√ß√£o <math id="eqn189" display="inline"><mrow><mi>H</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></math> produz uma lista com dois valores que subtra√≠dos a
<math id="eqn190" display="inline"><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></math> e <math id="eqn191" display="inline"><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow></math>, d√£o os valores de <math id="eqn192" display="inline"><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></math> e <math id="eqn193" display="inline"><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></math> de acordo com a
equa√ß√£o (<a href="#eq-1.10">1.10</a>).
</p>
<p>
Com valores iniciais <math id="eqn194" display="inline"><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mn>0.5</mn></mrow></math> e <math id="eqn195" display="inline"><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow></math>, vamos realizar 6 itera√ß√µes:
</p>
<pre>
<span class="maxp">(%i34)</span> <span class="maxi">[xi, yi]: [0.5, 1.0]$</span><br>
<span class="maxp">(%i35)</span> <span class="maxi">for i: 1 thru 6 do (</span><br>
          <span class="maxi">[xi, yi]: [xi, yi] - H(xi, yi),</span><br>
          <span class="maxi">print (xi, yi)</span><br>
       <span class="maxi">)$</span><br>
0.5833333333333334 1.8333333333333333 <br>
0.6089080459770115 1.6339080459770114 <br>
0.6178866256040898 1.6181915036528705 <br>
0.6180339655308434 1.6180340119919907 <br>
0.6180339887498943 1.6180339887498953 <br>
0.6180339887498949 1.6180339887498947
</pre>
<p>
Tendo em conta a simetria das solu√ß√µes, as quatro solu√ß√µes (<math id="eqn196" display="inline"><mrow><mi>x</mi></mrow></math>, <math id="eqn197" display="inline"><mrow><mi>y</mi></mrow></math>)
s√£o ent√£o: (0.6180, 1.6180), (1.6180, 0.6180), (-0.6180, -1.6180) e
(-1.6180, -0.6180).
</p>
</section>
<footer>
<p>&copy; 2016-2025, Jaime E. Villate</p>
<p>Publicado nos termos da <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Licen√ßa Creative Commons Atribui√ß√£o-Partilha</a> (vers√£o 4.0).</p>
<span>√öltima modifica√ß√£o: 2025/03/08 12:09:16 UTC</span>
</footer>
</body>
</html>
